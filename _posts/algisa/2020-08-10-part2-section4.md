---
layout: post
title: 정보보안기사 - Part 02. 암호학 (section 04. 비대칭키 암호)
category: 정보보안기사
tags: [정보보안기사, 암호학, 비대칭키암호]
comments: true
---
> 정보보안기사 알기사 1200제를 풀고 암기가 필요한 부분을 정리해 놓은 포스팅입니다.  
개인 공부후 자료를 남기기 위한 목점임으로 내용상에 오류가 있을 수 있습니다.

# Part 02. 암호학 (section 04. 비대칭키 암호)
## 키 배송 문제를 해결하기 위한 방법
1. **키의 사전 공유**에 의한 방법
2. **키 배포 센터**에 의한 방법
3. **Diffie-Hellman 키 교환**에 의한 방법
4. **공개키 암호**에 의한 방법

## KDC(Key Distribution Center) 기반 키 분배 방식
- 온라인 키분배(키 배포 센터를 이용한 방법)
- TA가 네트워크의 모든 사용자와 필요할 때마다 키를 공유하는 방법
- `대칭형` 암호에 필요한 세션기 등의 교환을 위해 사용됨
- 데이터베이스에 `n명`의 사원이 있다면 `n개`의 키가 있음

## 키 사전분배
- TA가 미리 사용자 사이의 대칭키를 만들어서 비밀경로를 통하여 전달하는 방법
- TA와 네트워크 상의 모든 사용자 사이에 안전한 통로가 필요함
- 사용자가 많을 수록 TA와 사용자들은 많은 키를 관리해야 함
- `n명`의 사용자가 있다면 각 사용자는 `n개`의 키를, TA는 $\frac{n(n-1)}{2}$개의 키를 관리해야 함
- 관리비용이 많이 지불됨

## RSA 기반 키 분배 방식
- **송신자**는 교환하고자 하는 **비밀키**를 `수신자의 공개키`로 암호화하여 수신자 측에 전송
- **수신자**는 `본인의 개인키`로 교환하고자 하는 **비밀키**를 복호화

## 공개키 암호화
- **송신자**는 `수신자의 공개키`를 이용해서 암호화
- **수신자**는 `자신의 개인키`를 이용해서 복호화

## 전자서명
- **송신자**는 `자신의 개인키`를 이용하여 문서에 서명
- **수신자**는 `송신자의 공개키`로 검증

## Diffie-Hellman 키 교환
- `유한체상의 이산대수 문제`를 풀기 어렵다는 사실에 기반
- 이산대수 문제 : $G^AmodP$에서 수 A를 구하는 문제
- 상대방의 공개키오 나의 개인키를 이용하여 계산을 통해 비밀키를 생성함
- 키 분배 센터는 `큰 소수` $p$를 선정하고 $Z_p$ 위에서 원시근 $g$를 찾아 공개한다.
- 가입자는 `개인키`를 선정하여 `공개키`를 계산하여 공개한다.

## Diffie-Hellman 키 교환 방법
1. 소수 $p$와 원시근 $a\in{Z_p}^*$를 공개한다.
2. B는 A의 인증서로부터 공개된 값 $b_A$와 자신의 비밀키(Key) $a_B$를 함께 사용하여 $K_{A,B}$ 값을 계산한다.  
	$K_{A*B}\equiv(b_A)^{a_B}mod p\equiv \alpha^{a_Aa_B}mod p$
3. A는 B의 인증서로부터 공개된 값 $b_B$와 자신의 비밀키(Key) $a_A$를 함께 사용하여 $K_{A,B}$ 값을 계산한다.
	$K_{A*B}\equiv(b_B)^{a_A}mod p\equiv \alpha^{a_Aa_B}mod p$

## Diffie-Hellman 키 교환 방법 - 비밀키 구하기
-  Diffie-Hellman 키 분배 프로토콜에서 사용하는 공개키 : $G^a mod p$ ($a$는 개인키)
- 송신자 A: $g=3$, $p=7$, $a=2$
- 수신자 B: $g=3$, $p=7$, $a=3$
- **송신자 A와 수신자 B가 분배받는 비밀키 값은?**
- 풀이 :
	$2^{2\times3} mod 7 = 3^6 mod 7$
	$= ((3^2 mod 7)\times(3^2 mod 7) \times(3^2 mod 7)) mod 7$
	$=(2\times2\times2) mod 7 = 1$

## 암호 알고리즘 - 부인 방지 기능
- `RSA, DSS, EIGamal`은 전자서명을 이용해 부인방지 서비스를 제공할 수 있음
- `ECDH(Elliptic Curve Diffie-Hellman)` : 타원곡선을 이용한 키 합의 프로토콜(부인 방지 기능 X)

## RSA 키 생성 알고리즘
1. $p$와 $q$라고 하는 두 개의 서로 다른 $(p\ne q)$ 소수를 고른다.
2. 두 수를 곱하여 $N=pq$를 찾는다.
3. $\phi(N)=(p-1)(q-1)$를 구한다.
4. $\phi(N)$보단 작고, $\phi(N)$과 서로수인 정수 $e$를 찾는다,
5. 확장된 유클리드 호제법을 이용하여 $d\times e$를 $\phi(N)$로 나누었을 때 나머지가 1인 정수 $d$를 구한다. $(de \equiv 1 mod \phi(N))$

## RSA 키 생성 알고리즘 - 평문 구하기
- 수신자의 공개키 (E, N) = (3, 15)
- 송신자가 전송한 암호문 C=7
- 평문 M은?
- 풀이 :
	n이 15일 때 조건을 만족하는 두 소수 p, q는 각각 3, 5이다.
	$\phi(N)=(p-1)(q-1) = (3-1)(5-1) = 8$
	$(d\times e) mod \phi(N) = 1$
	$(d\times3) mod 8 = 1$
	$\therefore d=3$
	최종적으로 $M=C^d mod N$이므로 $7^3 mod 15=13$이 된다.

## 공개키 암호시스템

| 알고리즘 | 암호/복호 | 디지털 서명 | 키 교환 |
| :------------: | :-----------: | :------------: | :------------: |
| RSA | Yes | Yes | Yes |
| Diffie-Hellman | No | No | Yes |
| DSS | No | Yes | No |
| 타원 곡선 | Yes | Yes | Yes |

## RSA 알고리즘 공격
1. 전사적 공격 : 모든 가능한 개인키를 조사
2. 수학적인 공격 : 여러가지 기법이 있지만, 이들의 복잡도는 모두 두 소수의 곱을 인수분해하는 것과 동일
3. 시간 공격 : 복호 알고리즘의 실행시간에 의존
4. 선택 암호문 공격 :  RSA 알고리즘의 속성을 이용
